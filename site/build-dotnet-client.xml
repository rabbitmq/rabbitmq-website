<?xml-stylesheet type="text/xml" href="page.xsl"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:doc="http://www.rabbitmq.com/namespaces/ad-hoc/doc">
  <head>
    <title>RabbitMQ - .Net/C# AMQP Client Library Build Instructions</title>
  </head>
  <body>
    <doc:div>
      <p class="intro">
	This section describes the process for obtaining a copy of the
	RabbitMQ .Net/C# AMQP client library source code, as well as
	instructions for building the .Net/C# client libraries from source.
      </p>

      <doc:toc class="compact">
	<doc:heading>Table of Contents</doc:heading>
      </doc:toc>

      <doc:section name="obtaining">
	<doc:heading>Obtaining the source</doc:heading>

	<ul>
	  <li>
	    Either download a released source code distribution from
	    the <a href="dotnet.html">download page</a>, or
	  </li>

	  <li>Check the code out directly from <a href="mercurial.html">our mercurial repositories</a>:
	    <pre class="sourcecode">$ hg clone http://hg.rabbitmq.com/rabbitmq-dotnet-client</pre>
	  </li>
	</ul>
      </doc:section>

      <doc:section name="prerequisites">
	<doc:heading>Required Libraries and Tools</doc:heading>

	<p>
	  To build the .NET/C# client libraries on Windows, you will need
	</p>

	<ul class="compact">
	  <li>
		Microsoft's .NET 1.1, 2.0, 3.0 or 3.5 (versions older
		than 3.0 do not support WCF)
	  </li>
	  <li>
        Microsoft Visual StudioÂ® 2005 or later (optional)
      </li>
    </ul>    
    </doc:section>

	<doc:section name="building">
	<doc:heading>Building the source</doc:heading>
     <doc:subsection name="building-on-windows-with-vs">
      <doc:heading>On Windows, with Visual Studio</doc:heading>
	  <p>
        To build the source with Visual Studio you need to:
      </p>
      <ul class="compact">
        <li>
          Copy <code>Local.props.example</code> to <code>Local.props</code> and
          edit the <code>&lt;PropTargetFramework&gt;</code> value to the
          desired target framework version. If this is v3.0 or newer, the WCF
          bindings will also be built.
        </li>
        <li>
          Open <code>RabbitMQDotNetClient.sln</code> in Visual
          Studio. That may fail if the version of Visual Studio used
          is different from the one that created the solution file. In
          most such cases this can be corrected by opening the
          solution file in a text editor and adjusting the Format
          Version number at the beginning.
        </li>
        <li>
          Build the solution. As part of the build process, Visual
          Studio will also launch some unit tests. To disable these,
          change the build configuration to
          <code>DebugNoTest</code>.
        </li>
      </ul>
     </doc:subsection>
     <doc:subsection name="building-on-windows-no-vs">
      <doc:heading>On Windows, without Visual Studio</doc:heading>
      <p>
        To build the source without Visual Studio you first need to make sure
        you have the .NET's framework directory in your path, which is usually
        <code>DRIVE:\Windows\Microsoft.NET\Framework\v2.0.50727</code>
        for .NET 2.0 or <code>DRIVE:\Windows\Microsoft.NET\Framework\v3.0</code>
        for .NET 3.0.
      </p>
      <ul class="compact">
        <li>
          Copy <code>Local.props.example</code> to <code>Local.props</code> and
          edit the <code>&lt;PropTargetFramework&gt;</code> value to the
          desired target framework version. If this is v3.0 or newer, the WCF
          bindings will also be built.
        </li>
        <li>
          Open the command prompt in the client directory, and type
          <pre class="sourcecode">&gt; msbuild.exe RabbitMQDotNetClient.sln</pre>
          For more information on msbuild.exe see <a href="http://msdn.microsoft.com/en-us/library/ms164311.aspx">the MSBuild command line reference</a>.
        </li>
      </ul>
     </doc:subsection>
     <doc:subsection name="building-on-linux">
      <doc:heading>On Linux</doc:heading>
      <p>
        The library can be built on Linux with Mono, but only with
        Mono version 2.6 and later.  2.4.x versions, as included with
        most current Linux distributions, are not sufficient.  You can
        obtain the latest versions of Mono at <a
        href="http://mono-project.com/">mono-project.com</a>
      </p>

      <p>
        Once you have installed a suitable version of Mono, and <a
        href="#obtaining">obtained the RabbitMQ .Net/C# AMQP client
        library source code</a>, to build the library you should:
      </p>

      <ul class="compact">
        <li>
          Copy <code>Local.props.example</code> to <code>Local.props</code>
          and edit the <code>&lt;PropUsingMono&gt;</code> value to be
          <code>true</code>.
        </li>
        <li>
          At a command prompt, go into the library source directory, and do
          <pre class="sourcecode">$ xbuild RabbitMQDotNetClient.sln</pre>
          For more information on xbuild see its man page.
        </li>
      </ul>
     </doc:subsection>
    </doc:section>
    </doc:div>
  </body>
</html>

